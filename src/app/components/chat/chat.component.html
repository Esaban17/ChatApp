<div class="main-layout">
    <!-- Navigation Start -->
    <div class="navigation navbar navbar-light bg-primary">
        <!-- Logo Start -->
        <a class="d-none d-xl-block bg-light rounded p-1" routerLink="/chat">
            <svg height="30" width="30" viewBox="0 0 512 511">
                <g>
                    <path
                        d="m120.65625 512.476562c-7.25 0-14.445312-2.023437-20.761719-6.007812-10.929687-6.902344-17.703125-18.734375-18.117187-31.660156l-1.261719-41.390625c-51.90625-46.542969-80.515625-111.890625-80.515625-183.992188 0-68.816406 26.378906-132.101562 74.269531-178.199219 47.390625-45.609374 111.929688-70.726562 181.730469-70.726562s134.339844 25.117188 181.730469 70.726562c47.890625 46.097657 74.269531 109.382813 74.269531 178.199219 0 68.8125-26.378906 132.097657-74.269531 178.195313-47.390625 45.609375-111.929688 70.730468-181.730469 70.730468-25.164062 0-49.789062-3.253906-73.195312-9.667968l-46.464844 20.5c-5.035156 2.207031-10.371094 3.292968-15.683594 3.292968zm135.34375-471.976562c-123.140625 0-216 89.816406-216 208.925781 0 60.667969 23.957031 115.511719 67.457031 154.425781 8.023438 7.226563 12.628907 17.015626 13.015625 27.609376l.003906.125 1.234376 40.332031 45.300781-19.988281c8.15625-3.589844 17.355469-4.28125 25.921875-1.945313 20.132812 5.554687 41.332031 8.363281 63.066406 8.363281 123.140625 0 216-89.816406 216-208.921875 0-119.109375-92.859375-208.925781-216-208.925781zm-125.863281 290.628906 74.746093-57.628906c5.050782-3.789062 12.003907-3.839844 17.101563-.046875l55.308594 42.992187c16.578125 12.371094 40.304687 8.007813 51.355469-9.433593l69.519531-110.242188c6.714843-10.523437-6.335938-22.417969-16.292969-14.882812l-74.710938 56.613281c-5.050781 3.792969-12.003906 3.839844-17.101562.046875l-55.308594-41.988281c-16.578125-12.371094-40.304687-8.011719-51.355468 9.429687l-69.554688 110.253907c-6.714844 10.523437 6.335938 22.421874 16.292969 14.886718zm0 0"
                        data-original="#000000" class="active-path" data-old_color="#000000" fill="#665dfe" />
                </g>
            </svg>
        </a>
        <!-- Logo End -->

        <!-- Main Nav Start -->
        <ul class="nav nav-minimal flex-row flex-grow-1 justify-content-between flex-xl-column justify-content-xl-center"
            id="mainNavTab" role="tablist">

            <!-- Chats Tab Start -->
            <li class="nav-item">
                <a class="nav-link p-0 py-xl-3 active" id="chats-tab" routerLink="/chat" title="Chats">
                    <!-- Default :: Inline SVG -->
                    <svg class="hw-24" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a1.994 1.994 0 01-1.414-.586m0 0L11 14h4a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2v4l.586-.586z" />
                    </svg>

                    <!-- Alternate :: External File link -->
                    <!-- <img class="injectable hw-24" src="./../assets/media/heroicons/outline/chat-alt-2.svg" alt="Chat icon"> -->
                </a>
            </li>
            <!-- Chats Tab End -->

            <!-- Friends Tab Start -->
            <li class="nav-item">
                <a class="nav-link p-0 py-xl-3" id="friends-tab" routerLink="/users" title="Agregar usuarios">
                    <svg class="hw-24" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
                    </svg>
                </a>
            </li>
            <!-- Friends Tab End -->

            <!-- Profile Tab Start -->
            <li class="nav-item">
                <a class="nav-link p-0 py-xl-3" id="profile-tab" routerLink="/profile" title="Perfil">
                    <svg class="hw-24" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                </a>
            </li>
            <!-- Profile Tab End -->

            <!-- Logout Tab Start -->
            <li class="nav-item">
                <a class="nav-link p-0 py-xl-3 " style="cursor: pointer;" id="calls-tab" title="Cerrar Sesión"
                    (click)="logout()">
                    <!-- Default :: Inline SVG -->
                    <svg class="hw-18 d-none d-sm-inline-block" fill="none" viewBox="0 0 20 20" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1" />
                    </svg>

                    <!-- Alternate :: External File link -->
                    <!-- <img class="injectable hw-24" src="./../assets/media/heroicons/outline/phone.svg" alt="Phone icon"> -->
                </a>
            </li>
            <!-- Logout Tab End -->
        </ul>
        <!-- Main Nav End -->
    </div>
    <!-- Navigation End -->

    <!-- Sidebar Start -->
    <aside class="sidebar">
        <!-- Tab Content Start -->
        <div class="tab-content">
            <!-- Chat Tab Content Start -->
            <div class="tab-pane active" id="chats-content">
                <div class="d-flex flex-column h-100">
                    <div class="hide-scrollbar h-100" id="chatContactsList">

                        <!-- Chat Header Start -->
                        <div class="sidebar-header sticky-top p-2">

                            <div class="d-flex justify-content-between align-items-center">
                                <!-- Chat Tab Pane Title Start -->
                                <h5 class="font-weight-semibold mb-0">CHATS</h5>
                                <!-- Chat Tab Pane Title End -->

                                <ul class="nav flex-nowrap">

                                    <li class="nav-item list-inline-item mr-1">
                                        <a class="nav-link text-muted px-1" href="#" title="Invitations" role="button"
                                            data-toggle="modal" data-target="#inviteOthers" (click)="getInvitations()">
                                            <svg class="hw-24" fill="none" viewBox="0 0 25 25" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                    d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
                                            </svg>
                                        </a>
                                    </li>

                                    <li class="nav-item list-inline-item mr-1">
                                        <a class="nav-link text-muted px-1" href="#" title="Notifications" role="button"
                                            data-toggle="modal" data-target="#notificationModal"
                                            (click)="getInvitations()">
                                            <svg class="hw-20" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                    d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
                                            </svg>
                                        </a>
                                    </li>
                                </ul>
                            </div>

                            <!-- Sidebar Header Start -->
                            <div class="sidebar-sub-header">
                                <!-- Sidebar Search Start -->
                                <form class="form-inline">
                                    <div class="input-group">
                                        <input type="text"
                                            class="form-control search border-right-0 transparent-bg pr-0"
                                            placeholder="Buscar contacto...">
                                        <div class="input-group-append">
                                            <div class="input-group-text transparent-bg border-left-0" role="button">
                                                <!-- Default :: Inline SVG -->
                                                <svg class="text-muted hw-20" fill="none" viewBox="0 0 24 24"
                                                    stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2"
                                                        d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                                                </svg>

                                                <!-- Alternate :: External File link -->
                                                <!-- <img class="injectable hw-20" src="./../assets/media/heroicons/outline/search.svg" alt=""> -->
                                            </div>
                                        </div>
                                    </div>
                                </form>
                                <!-- Sidebar Search End -->
                            </div>
                            <!-- Sidebar Header End -->
                        </div>
                        <!-- Chat Header End -->

                        <!-- Chat Contact List Start -->
                        <ul class="contacts-list" id="chatContactTab" data-chat-list="">
                            <!-- Chat Item Start -->
                            <li class="contacts-item friends" *ngFor="let item of contacts"
                                (click)="selectChat(item.friend)">
                                <a class="contacts-link">
                                    <div class="avatar avatar-online"><img [src]="GetImage(item.friend.photo)"
                                            alt="Image Friend">
                                    </div>
                                    <div class="contacts-content">
                                        <div class="contacts-info">
                                            <h6 class="chat-name">{{item.friend.username}}</h6>
                                        </div>
                                    </div>
                                </a>
                            </li>
                            <!-- Chat Item End -->
                        </ul>
                        <!-- Chat Contact List End -->
                    </div>
                </div>
            </div>
            <!-- Chats Tab Content End -->
        </div>
        <!-- Tab Content End -->
    </aside>
    <!-- Sidebar End -->

    <!-- Main Start -->
    <main class="main main-visible">

        <!-- Chats Page Start -->
        <div class="chats">
            <div class="chat-body">
                <!-- Chat Header Start-->
                <div class="chat-header">
                    <button class="btn btn-secondary btn-icon btn-minimal btn-sm text-muted d-xl-none" type="button"
                        data-close="">
                        <!-- Default :: Inline SVG -->
                        <svg class="hw-20" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                        </svg>
                    </button>

                    <!-- Chat participant's Name -->
                    <div class="media chat-name align-items-center text-truncate" *ngIf="chatSelected">
                        <div class="avatar avatar-online d-none d-sm-inline-block mr-3">
                            <img [src]="GetImage(friend.photo)" alt="Friend Image">
                        </div>

                        <div class="media-body align-self-center ">
                            <h6 class="text-truncate mb-0">{{friend.username}}</h6>
                            <small class="text-muted">Online</small>
                        </div>
                    </div>
                </div>
                <!-- Chat Header End-->

                <!-- Search Start -->
                <div class="collapse border-bottom px-3" id="searchCollapse" *ngIf="chatSelected">
                    <div class="container-xl py-2 px-0 px-md-3">
                        <div class="input-group bg-light ">
                            <input type="text" class="form-control form-control-md border-right-0 transparent-bg pr-0"
                                placeholder="Search...">
                            <div class="input-group-append">
                                <span class="input-group-text transparent-bg border-left-0">
                                    <!-- Default :: Inline SVG -->
                                    <svg class="hw-20 text-muted" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                                    </svg>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Search End -->

                <!-- Chat Content Start-->
                <div class="chat-content p-2" id="messageBody">
                    <div class="container" *ngIf="chatSelected">
                        <!-- Message Day Start -->
                        <div class="message-day">
                            <div class="message-divider sticky-top pb-2" data-label="Hoy">&nbsp;</div>
                            <ng-container *ngFor="let item of currentChatMessages">
                                <!-- Received Message Start -->
                                <div class="message" *ngIf="item.sender != userLogged.username && !item.isFile">
                                    <div class="message-wrapper">
                                        <div class="message-content">
                                            <span>{{item.message}}</span>
                                        </div>
                                    </div>
                                    <div class="message-options">
                                        <div class="avatar avatar-sm"><img alt="" [src]="GetImage(friend.photo)">
                                        </div>
                                        <!-- <span class="message-date">9:12am</span> -->
                                    </div>
                                </div>
                                <!-- Received Message End -->
                                <!-- Self Message Start -->
                                <div class="message self" *ngIf="item.sender == userLogged.username && !item.isFile">
                                    <div class="message-wrapper">
                                        <div class="message-content">
                                            <span>{{item.message}}</span>
                                        </div>
                                    </div>
                                    <div class="message-options">
                                        <div class="avatar avatar-sm"><img alt="" [src]="GetImage(userLogged.photo)">
                                        </div>
                                        <!-- <span class="message-date">9:12am</span> -->
                                    </div>
                                </div>
                                <!-- Self Message End -->
                                <!-- Message Start -->
                                <div class="message" *ngIf="item.sender != userLogged.username && item.isFile">
                                    <div class="message-wrapper">
                                        <div class="message-content">
                                            <div class="document">
                                                <div class="btn btn-primary btn-icon rounded-circle text-light mr-2">
                                                    <!-- Default :: Inline SVG -->
                                                    <svg class="hw-24" fill="none" viewBox="0 0 24 24"
                                                        stroke="currentColor" (click)="downloadFile(item)">
                                                        <path stroke-linecap="round" stroke-linejoin="round"
                                                            stroke-width="2"
                                                            d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
                                                    </svg>
                                                </div>
                                                <div class="document-body">
                                                    <h6>
                                                        <a class="text-reset">{{item.fileName}}</a>
                                                    </h6>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- Message End -->
                                <!-- Message Start -->
                                <div class="message self" *ngIf="item.sender == userLogged.username && item.isFile">
                                    <div class="message-wrapper">
                                        <div class="message-content">
                                            <div class="document">
                                                <div class="btn btn-primary btn-icon rounded-circle text-light mr-2">
                                                    <!-- Default :: Inline SVG -->
                                                    <svg class="hw-24" fill="none" viewBox="0 0 24 24"
                                                        stroke="currentColor" (click)="downloadFile(item)">
                                                        <path stroke-linecap="round" stroke-linejoin="round"
                                                            stroke-width="2"
                                                            d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
                                                    </svg>
                                                </div>
                                                <div class="document-body">
                                                    <h6>
                                                        <a class="text-reset">{{item.fileName}}</a>
                                                    </h6>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- Message End -->
                            </ng-container>
                        </div>
                        <!-- Message Day End -->
                    </div>

                    <!-- Scroll to finish -->
                    <div class="chat-finished" id="chat-finished"></div>
                </div>
                <!-- Chat Content End-->

                <!-- Chat Footer Start-->
                <div class="chat-footer" *ngIf="chatSelected">
                    <div class="attachment">
                        <input type="file" style="display:none" (change)="onFileSelected($event)" #file>
                        <button class="btn btn-secondary btn-icon btn-minimal btn-sm" type="button"
                            (click)="file.click()">
                            <svg class="hw-20" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                        </button>
                    </div>

                    <textarea [(ngModel)]="message" class="form-control emojionearea-form-control" style="resize: none;"
                        id="messageInput" rows="1" placeholder="Type your message here..."
                        [disabled]="isFile"></textarea>
                    <div class="btn btn-primary btn-icon send-icon rounded-circle text-light mb-1" role="button"
                        (click)="sendPrivate()">
                        <svg class="hw-24" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M14 5l7 7m0 0l-7 7m7-7H3" />
                        </svg>
                    </div>
                </div>
                <!-- Chat Footer End-->
            </div>
        </div>
        <!-- Chats Page End -->
    </main>
    <!-- Main End -->

    <div class="backdrop"></div>

    <!-- Modal 1 :: Invitations -->
    <div class="modal modal-lg-fullscreen fade" id="inviteOthers" tabindex="-1" role="dialog"
        aria-labelledby="inviteOthersLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-dialog-zoom">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="inviteOthersLabel">Solicitudes de amistad</h5>

                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body p-0 hide-scrollbar">
                    <div class="row">
                        <div class="col-12">
                            <!-- List Group Start -->
                            <ul class="list-group list-group-flush  py-2">
                                <!-- List Group Item Start -->
                                <ng-container *ngFor="let item of invitations">
                                    <li class="list-group-item"
                                        *ngIf="item.receiver == userLogged.username && item.status == 'sent'">
                                        <div class="media">
                                            <div class="btn btn-primary btn-icon rounded-circle text-light mr-2">
                                                <svg class="hw-24" fill="none" viewBox="0 0 24 24"
                                                    stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2"
                                                        d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z" />
                                                </svg>
                                            </div>

                                            <div class="media-body">
                                                <h6>
                                                    <a href="#">{{item.sender}}</a> Te envió una solicitud
                                                </h6>

                                                <p class="text-muted mb-0">5 mins ago</p>
                                            </div>
                                        </div>
                                        <div class="d-flex justify-content-center mt-2">
                                            <button type="button" class="btn btn-outline-danger mx-1"
                                                (click)="acceptOrDecline(false,item);">Rechazar</button>
                                            <button type="button" class="btn btn-primary mx-1"
                                                (click)="acceptOrDecline(true,item);">Aceptar</button>
                                        </div>
                                    </li>
                                </ng-container>
                            </ul>
                            <!-- List Group End -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal 2 :: Notifications -->
    <div class="modal modal-lg-fullscreen fade" id="notificationModal" tabindex="-1" role="dialog"
        aria-labelledby="notificationModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-dialog-zoom">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="notificationModalLabel">Notificaciones</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body p-0 hide-scrollbar">
                    <div class="row">
                        <div class="col-12">
                            <!-- List Group Start -->
                            <ul class="list-group list-group-flush  py-2">
                                <!-- List Group Item Start -->
                                <ng-container *ngFor="let item of invitations">
                                    <li class="list-group-item"
                                        *ngIf="item.receiver == userLogged.username && item.status == 'sent'">
                                        <div class="media">
                                            <div class="btn btn-primary btn-icon rounded-circle text-light mr-2">
                                                <svg class="hw-24" fill="none" viewBox="0 0 24 24"
                                                    stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2"
                                                        d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z" />
                                                </svg>
                                            </div>

                                            <div class="media-body">
                                                <h6>
                                                    <a href="#">{{item.sender}}</a> Te envió una solicitud
                                                </h6>

                                                <p class="text-muted mb-0">5 mins ago</p>
                                            </div>
                                        </div>
                                        <div class="d-flex justify-content-center mt-2">
                                            <button type="button" class="btn btn-outline-danger mx-1"
                                                (click)="acceptOrDecline(false,item);">Rechazar</button>
                                            <button type="button" class="btn btn-primary mx-1"
                                                (click)="acceptOrDecline(true,item);">Aceptar</button>
                                        </div>
                                    </li>

                                    <li class="list-group-item"
                                        *ngIf="item.sender == userLogged.username && item.status == 'accepted'">
                                        <div class="media">
                                            <div class="btn btn-primary btn-icon rounded-circle text-light mr-2">
                                                <!-- Default :: Inline SVG -->
                                                <svg class="hw-24" fill="none" viewBox="0 0 24 24"
                                                    stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2"
                                                        d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                                                </svg>

                                                <!-- Alternate :: External File link -->
                                                <!-- <img class="injectable hw-24" src="./../assets/media/heroicons/outline/check-circle.svg" alt=""> -->
                                            </div>

                                            <div class="media-body">
                                                <h6>
                                                    <a href="#">{{item.receiver}}</a> Aceptó tu solicitud
                                                </h6>

                                                <p class="text-muted mb-0">25 mins ago</p>
                                            </div>
                                        </div>
                                    </li>

                                    <li class="list-group-item"
                                        *ngIf="item.sender == userLogged.username && item.status == 'declined'">
                                        <div class="media">
                                            <div class="btn btn-primary btn-icon rounded-circle text-light mr-2">
                                                <i class="fas fa-times-circle" style="font-size: 20px;"></i>
                                            </div>

                                            <div class="media-body">
                                                <h6>
                                                    <a href="#">{{item.receiver}}</a> Rechazó tu solicitud
                                                </h6>

                                                <p class="text-muted mb-0">5 mins ago</p>
                                            </div>
                                        </div>
                                    </li>
                                </ng-container>
                            </ul>
                            <!-- List Group End -->
                        </div>
                    </div>
                </div>
                <!-- <div class="modal-footer justify-content-center">
                    <button type="button" class="btn btn-link text-muted">Clear all</button>
                </div> -->
            </div>
        </div>
    </div>
</div>